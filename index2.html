<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy Birthday Sam</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@400;600&family=Titan+One&family=Sriracha&display=swap" rel="stylesheet">
    
    <style>
        /* --- CORE RESET --- */
        * { padding: 0; margin: 0; box-sizing: border-box; }
        :root {
            --pink: #feecea;
            --white: #fff;
            --black: #333;
            --text-pink: #449bff;
            --heart: #FF7882;
            --cake-base: #5D4037;
            --icing: #3E2723;
            --cherry: #D32F2F;
        }

        /* --- LOADING SCREEN --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            transition: opacity 1s ease-out;
        }
        .spinner {
            width: 50px; height: 50px; border: 5px solid #333;
            border-top: 5px solid var(--heart); border-radius: 50%;
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        #loader h2 { font-family: 'Poppins'; color: white; font-size: 1rem; letter-spacing: 2px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- FIREFLIES --- */
        .firefly {
            position: fixed; width: 4px; height: 4px; background-color: #ffeb3b;
            border-radius: 50%; box-shadow: 0 0 10px #ffeb3b, 0 0 20px #ffeb3b;
            opacity: 0; pointer-events: none; z-index: 1;
            animation: fly 10s infinite linear;
        }
        @keyframes fly {
            0% { transform: translate(0, 0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translate(100px, -150px); opacity: 0; }
        }

        body {
            background: #000 url('./images/wp6001771.jpg') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Poppins', sans-serif; color: var(--white);
            height: 100vh; height: 100dvh; overflow: hidden;
        }

        #wrapper {
            width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6);
            position: relative; display: flex; flex-direction: column; align-items: center;
        }

        /* --- 1. TITLE & FLAGS --- */
        .flag__birthday {
            position: absolute; top: -10px; width: 100%;
            display: flex; justify-content: space-between; pointer-events: none; z-index: 1;
        }
        .flag__birthday .flag__left { transform: rotate(-10deg) translate(-10px, 10px); width: 150px; }
        .flag__birthday .flag__right { transform: rotate(10deg) translate(10px, 10px) scaleX(-1); width: 150px; }

        .title {
            position: relative; 
            margin-top: 70px; 
            z-index: 10; 
            text-align: left; 
            padding-left: 25px; 
            font-family: "Titan One", sans-serif; 
            font-size: 3.5rem; 
            width: 100%;
            line-height: 1.1;
        }
        .title .happy { color: var(--white); text-shadow: 4px 4px 0 var(--black); display: block; }
        .title .birthday { color: var(--text-pink); text-shadow: 4px 4px 0 var(--black); display: block; }

        /* --- 2. ANIMATIONS TRIGGER ONLY AFTER LOAD --- */
        
        /* FLYING PHOTO */
        .flying-container {
            position: absolute; bottom: -600px; left: 50%; transform: translateX(-50%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            width: 350px; z-index: 5; opacity: 0;
        }
        body.loaded .flying-container {
            opacity: 1;
            animation: flyUpWithBalloons 6s cubic-bezier(0.17, 0.67, 0.31, 1.15) forwards;
            animation-delay: 0.5s;
        }
        @keyframes flyUpWithBalloons { 0% { bottom: -600px; } 100% { bottom: 42%; } }
        
        .floating-content { animation: gentleFloat 3s infinite ease-in-out; animation-delay: 6.5s; }
        @keyframes gentleFloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        .image-box {
            width: 330px; height: 330px; border-radius: 50%; border: 8px solid var(--white); 
            overflow: hidden; background: #fff;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; z-index: 2;
        }
        .image-box img { width: 100%; height: 100%; object-fit: cover; }
        .balloon-set { position: absolute; top: -80px; width: 100%; display: flex; justify-content: space-between; pointer-events: none; z-index: 3; }
        .balloon-set img { width: 80px; } 

        /* --- MOVED LOVE CLOCK (TOP RIGHT) --- */
        /* --- MOVED LOVE CLOCK (TOP RIGHT) --- */
.love-clock {
    position: absolute; 
    top: 50px; /* Moved UP to the corner */
    right: 20px; 
    left: auto; 
    background: rgba(255,255,255,0.2); backdrop-filter: blur(10px);
    border-radius: 20px; padding: 15px 20px;
    border: 2px solid rgba(255,255,255,0.3);
    font-size: 1.1rem; 
    text-align: center; opacity: 0;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    z-index: 20; 
}
        body.loaded .love-clock {
            animation: slideInRight 1s forwards; animation-delay: 5s; /* Changed animation to slide from right */
        }
        @keyframes slideInRight { from { transform: translateX(50px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* MUSIC CONTROL */
        /* MUSIC CONTROL */
.music-control {
    position: absolute; 
    top: 140px; /* Moved DOWN below the clock */
    right: 20px;
    background: rgba(255,255,255,0.2); backdrop-filter: blur(5px);
    border: 1px solid rgba(255,255,255,0.5); width: 50px; height: 50px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; z-index: 100; color: white; font-size: 1.4rem;
}

        /* BUTTON */
        .main-action {
            position: absolute; bottom: 25%; left: 50%; transform: translateX(-50%);
            opacity: 0; z-index: 20; width: 100%; text-align: center;
        }
        body.loaded .main-action {
            animation: fadeUpBtn 1s forwards; animation-delay: 6s;
        }
        #btn__letter {
            background: var(--text-pink); color: white; border: none; 
            padding: 15px 40px; border-radius: 50px; font-family: "Sriracha", cursive; 
            font-size: 1.3rem; box-shadow: 0 5px 15px rgba(68, 155, 255, 0.5); cursor: pointer; transition: transform 0.2s;
        }
        #btn__letter:active { transform: scale(0.95); }
        @keyframes fadeUpBtn { from { opacity: 0; transform: translate(-50%, 20px); } to { opacity: 1; transform: translate(-50%, 0); } }

        /* SLIDER */
        .slide-action {
            position: absolute; top: 240px; left: 50%; transform: translateX(-50%) scale(1.1);
            width: 250px; opacity: 0;
        }
        body.loaded .slide-action {
            animation: fadeInSlide 1s 6s forwards; 
        }
        @keyframes fadeInSlide { from { opacity: 0; } to { opacity: 1; } }

        .slider-lock {
            width: 100%; height: 55px; background: rgba(255, 255, 255, 0.2);
            border-radius: 50px; backdrop-filter: blur(5px); padding: 5px;
            overflow: hidden; position: relative; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .slider-text {
            position: absolute; width: 100%; text-align: center; top: 50%;
            transform: translateY(-50%); font-size: 1rem; color: rgba(255, 255, 255, 0.9);
            pointer-events: none; font-family: 'Sriracha', cursive; padding: 0 10px;
        }
        .slider-knob {
            width: 45px; height: 45px; background: var(--heart); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; color: white;
            position: absolute; left: 5px; top: 5px; cursor: grab; transition: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        .slider-knob i { animation: pulseArrow 1s infinite; font-size: 1.2rem; }
        @keyframes pulseArrow { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* CAKE */
        .cake-wrapper {
            position: absolute; bottom: 60px; left: 50%; 
            transform: translateX(-50%) scale(1.3);
            display: flex; flex-direction: column; align-items: center; z-index: 10;
        }
        .cake {
            width: 150px; height: 80px; background: var(--cake-base);
            border-radius: 10px 10px 5px 5px; position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .cake::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; opacity: 0.9; height: 30px;
            background: var(--icing); border-radius: 10px 10px 5px 5px;
            background-image: radial-gradient(circle at 10px 15px, var(--icing) 12px, transparent 13px);
            background-size: 20px 40px; background-repeat: repeat-x;
        }
        .plate {
            width: 180px; height: 10px; background: #eee; border-radius: 10px;
            margin-top: -5px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .candle-container { position: relative; bottom: -5px; transform: scale(1.2); cursor: pointer; }
        .candle-stick { width: 15px; height: 40px; background: linear-gradient(to right, #e74c3c, #ff9a9e); border-radius: 4px; }
        .flame {
            width: 15px; height: 15px; background: orange; border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 10px orange, 0 0 20px yellow;
            animation: flicker 0.1s infinite; position: absolute; top: -15px; left: 0;
        }
        .smoke { opacity: 0; position: absolute; top: -30px; left: -5px; color: #aaa; font-size: 20px; transition: 1s; }
        .candle-container.blown .flame { display: none; }
        .candle-container.blown .smoke { opacity: 1; transform: translateY(-20px); }
        @keyframes flicker { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(0.9); opacity: 0.8; } }

        .wish-text {
            position: absolute; top: -50px; width: 150px; left: 50%; transform: translateX(-50%);
            text-align: center; font-size: 0.8rem; color: #fff; pointer-events: none;
            animation: floatText 2s infinite ease-in-out;
        }
        @keyframes floatText { 0%, 100% { transform: translate(-50%, 0); } 50% { transform: translate(-50%, -5px); } }

        /* HEARTS */
        .floating-heart {
            position: fixed; bottom: -50px; color: var(--heart); font-size: 20px;
            animation: floatUpHeart 4s linear forwards; pointer-events: none; z-index: 50;
        }
        @keyframes floatUpHeart { 0% { transform: translateY(0) scale(0.5); opacity: 1; } 100% { transform: translateY(-100vh) scale(1.2); opacity: 0; } }

        /* MODAL */
        .message-display { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:none; justify-content:center; align-items:center; z-index:1000; }
        .message-display.active { display: flex; }
        .message-container { background: #fff; color: #333; padding: 25px; border-radius: 20px; width: 90%; max-height: 80vh; overflow-y: scroll; text-align: center; position: relative; }
        
        .candle-msg {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: white; color: #333; padding: 20px 30px; border-radius: 50px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); font-family: 'Sriracha', cursive; font-size: 1.2rem;
            z-index: 2000; transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: center; pointer-events: none;
        }
        .candle-msg.show { transform: translate(-50%, -50%) scale(1); }

        /* ====================================================== */
        /* LARGE SCREEN / DESKTOP MODE SCALING FIX */
        /* ====================================================== */
        @media (min-width: 768px) {
            .title { margin-top: 80px; font-size: 5rem; padding-left: 50px; }
            .flag__birthday .flag__left, .flag__birthday .flag__right { width: 250px; }
            .flying-container { width: 600px; }
            .image-box { width: 550px; height: 550px; border-width: 12px; }
            .cake-wrapper { transform: translateX(-50%) scale(2.0); bottom: 100px; }
            .main-action { bottom: 30%; transform: translateX(-50%) scale(1.5); }
            .slide-action { top: 300px; transform: translateX(-50%) scale(1.5); }
            
            /* Desktop Clock Position */
            .love-clock { 
                font-size: 1.5rem; 
                padding: 25px; 
                top: 100px; /* Aligned with top section */
                right: 40px; 
                left: auto;
            }
            .music-control { width: 60px; height: 60px; font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div id="loader">
        <div class="spinner"></div>
        <h2>LOADING LOVE...</h2>
    </div>

    <audio id="bg-music" loop preload="auto" src="./images/divine_9ew96escn38_ee00160e.mp3"></audio>
    
    <div id="wrapper">
        <div class="flag__birthday">
            <img src="./images/1.png" class="flag__left">
            <img src="./images/1.png" class="flag__right">
        </div>

        <div class="title">
            <span class="happy">Happy</span>
            <span class="birthday">Birthday</span>
        </div>

        <div class="flying-container">
            <div class="floating-content">
                <div class="balloon-set">
                    <img src="./images/balloon1.png" class="b-left">
                    <img src="./images/balloon2.png" class="b-right">
                </div>
                <div class="image-box">
                    <img src="./images/unnamed.jpg" alt="Sam">
                </div>
            </div>
        </div>

        <div class="love-clock">
            <span>Since you came into my lifeüòò</span><br>
            <span id="timer" style="color:var(--text-pink); font-weight:bold;">0d 0h</span>
        </div>

        <button class="music-control" onclick="toggleMusic()">
            <i class="fa-solid fa-music" id="music-icon"></i>
        </button>

        <div class="main-action">
            <button id="btn__letter">
                Click here zuzuu‚ù§Ô∏è <i class="fa-regular fa-envelope"></i>
            </button>
        </div>

        <div class="slide-action" id="slide-action-wrapper" style="z-index: 20;">
            <div class="slider-lock" id="slider-container">
                <div class="slider-text" id="slider-text">Slide to unlock my feelings ‚ù§Ô∏è</div>
                <div class="slider-knob" id="slider-knob">
                    <i class="fa-solid fa-chevron-right"></i>
                </div>
            </div>
        </div>

        <div class="cake-wrapper">
            <div class="wish-text" id="wish-msg">Make a wish & tap!</div>
            <div class="candle-container" id="candle" onclick="blowCandle()">
                <div class="smoke"><i class="fa-solid fa-wind"></i></div>
                <div class="flame"></div>
                <div class="candle-stick"></div>
            </div>
            <div class="cake"></div>
            <div class="plate"></div>
        </div>

        <div id="candle-msg" class="candle-msg">
            May all your wishes come true! ‚ú®
        </div>

        <div class="message-display">
            <div class="message-container">
                <button class="close-message" style="position:absolute; right:20px; top:20px; border:none; background:none; font-size:1.5rem; cursor:pointer;"><i class="fa-solid fa-times"></i></button>
                <h2 style="font-family:'Dancing Script'; color:#0752f4; margin-bottom:15px; font-size: 3.5rem; line-height: 1.2;">Meri Choti Don‚ù§Ô∏è</h2>
                <div class="typing-text" id="msg-text" style="text-align:left; line-height:1.6; font-size: 0.95rem;"></div>
            </div>
        </div>

    </div>

    <script>
        // --- 1. LOADER LOGIC ---
        window.addEventListener('load', () => {
            const loader = document.getElementById('loader');
            loader.style.opacity = '0';
            document.body.classList.add('loaded');
            setTimeout(() => { loader.style.display = 'none'; }, 1000);
        });

        // --- CONFIG ---
        const startDate = new Date(2025, 6, 27); // Change this to past date!

        const music = document.getElementById('bg-music');
        const musicIcon = document.getElementById('music-icon');
        let isPlaying = false;

        setInterval(() => {
            const now = new Date();
            const diff = now - startDate;
            const d = Math.floor(diff / (1000*60*60*24));
            document.getElementById('timer').innerText = `${d} Days`;
        }, 1000);

        function toggleMusic() {
            if(isPlaying) {
                music.pause();
                musicIcon.className = "fa-solid fa-music";
                musicIcon.style.animation = "none";
            } else {
                music.play();
                musicIcon.className = "fa-solid fa-compact-disc";
                musicIcon.style.animation = "spin 2s linear infinite";
            }
            isPlaying = !isPlaying;
        }

        function blowCandle() {
            const c = document.getElementById('candle');
            const msg = document.getElementById('candle-msg');

            if(!c.classList.contains('blown')) {
                c.classList.add('blown');
                document.getElementById('wish-msg').innerText = "Wish Granted! ‚ú®";
                msg.classList.add('show');
                setTimeout(() => { msg.classList.remove('show'); }, 3000);
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.8 }, colors: ['#FFA500', '#FF4500'] });
            }
        }

        function createFloatingHearts() {
            setInterval(() => {
                const heart = document.createElement('div');
                heart.classList.add('floating-heart');
                heart.innerHTML = '<i class="fa-solid fa-heart"></i>';
                heart.style.left = Math.random() * 100 + "vw";
                heart.style.animationDuration = Math.random() * 2 + 3 + "s"; 
                document.body.appendChild(heart);
                setTimeout(() => { heart.remove() }, 5000);
            }, 300);
        }

        document.getElementById('btn__letter').addEventListener('click', () => {
            if(!isPlaying) toggleMusic();
            document.querySelector('.message-display').classList.add('active');

            // Confetti
            var duration = 3 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 2000 };
            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) { return clearInterval(interval); }
                var particleCount = 50 * (timeLeft / duration);
                confetti({ ...defaults, particleCount, origin: { x: 0.1, y: 0.9 }, shapes: ['heart'], colors: ['#ff6b6b', '#ff9ff3'] });
                confetti({ ...defaults, particleCount, origin: { x: 0.9, y: 0.9 }, shapes: ['heart'], colors: ['#ff6b6b', '#ff9ff3'] });
            }, 250);

            createFloatingHearts();
            
            const text = "to the girl who make my life beautifulüë©\n\nI wanted to build this because a simple card or text just did'nt feel like enough to hold everthing i feel for you. You are the best part of my everyday and the love of lifeüòò\n\nThank u for ur kindness, ur laugther and the love u give freelyüòÅ\n\nI built this site line by line, just like we are building our future day by dayüòã\n\nit's just pure happiness that i found youüòö\n\nWishing you a day filled with happiness, love, and all the things that make you smile. üòá\n\nI'm truly grateful to have you in my life ‚Äî your kindness, strength, and genuine heart inspire me every day. üí´\n\nThank you for being such a wonderful presence and always bringing positive energy in my life. üíñ\n\nMany happy returns of the day zuzuuuu! üéÇüòä";
            
            const target = document.getElementById('msg-text');
            target.innerHTML = "";
            let i = 0;
            if(window.typeTimer) clearInterval(window.typeTimer);
            window.typeTimer = setInterval(() => {
                if(i < text.length) {
                    if(text.charAt(i) === "\n") { target.innerHTML += "<br>"; } else { target.innerHTML += text.charAt(i); }
                    i++;
                } else clearInterval(window.typeTimer);
            }, 40);
        });

        document.querySelector('.close-message').addEventListener('click', () => {
            document.querySelector('.message-display').classList.remove('active');
        });

        const style = document.createElement('style');
        style.innerHTML = `@keyframes spin { 100% { transform: rotate(360deg); } }`;
        document.head.appendChild(style);

        // Fireflies
        function createFireflies() {
            const firefly = document.createElement('div');
            firefly.className = 'firefly';
            firefly.style.left = Math.random() * 100 + 'vw';
            firefly.style.top = Math.random() * 100 + 'vh';
            const size = Math.random() * 3 + 2;
            firefly.style.width = size + 'px';
            firefly.style.height = size + 'px';
            firefly.style.animationDuration = Math.random() * 5 + 5 + 's';
            document.body.appendChild(firefly);
            setTimeout(() => { firefly.remove(); }, 10000);
        }
        setInterval(createFireflies, 500);

        // --- SLIDER LOGIC ---
        const SLIDE_THRESHOLD = 150; 
        let slideStartX = 0;
        let slideCurrentX = 0;
        const knob = document.getElementById('slider-knob');
        const sliderContainer = document.getElementById('slider-container');
        const sliderText = document.getElementById('slider-text');

        function handleSlide(e) {
            let clientX;
            if (e.touches) {
                e.preventDefault(); 
                clientX = e.touches[0].clientX;
            } else { clientX = e.clientX; }

            const rect = sliderContainer.getBoundingClientRect();
            let newX = clientX - slideStartX;
            if (newX < 0) newX = 0;
            const maxX = rect.width - knob.offsetWidth - 6;
            if (newX > maxX) newX = maxX;
            
            slideCurrentX = newX;
            knob.style.transform = `translateX(${slideCurrentX}px)`;

            if (slideCurrentX >= SLIDE_THRESHOLD) {
                sliderText.textContent = 'Unlocked! Redirecting...';
                knob.style.backgroundColor = '#4CAF50'; 
                setTimeout(() => { window.location.href = 'message.html'; }, 500); 
                removeSlideListeners();
            }
        }

        function resetSlide() {
            if (slideCurrentX < SLIDE_THRESHOLD) {
                knob.style.transition = 'transform 0.3s ease-out';
                knob.style.transform = 'translateX(0px)';
                slideCurrentX = 0;
                setTimeout(() => knob.style.transition = 'none', 300);
            }
            removeSlideListeners();
        }

        function addSlideListeners(e) {
            document.body.style.overflow = 'hidden'; 
            slideStartX = e.touches ? e.touches[0].clientX - knob.getBoundingClientRect().left : e.clientX - knob.getBoundingClientRect().left;
            document.addEventListener('mousemove', handleSlide);
            document.addEventListener('mouseup', resetSlide);
            document.addEventListener('touchmove', handleSlide, { passive: false }); 
            document.addEventListener('touchend', resetSlide);
        }

        function removeSlideListeners() {
            document.body.style.overflow = 'auto'; 
            document.removeEventListener('mousemove', handleSlide);
            document.removeEventListener('mouseup', resetSlide);
            document.removeEventListener('touchmove', handleSlide);
            document.removeEventListener('touchend', resetSlide);
        }

        if (knob && sliderContainer) {
            knob.addEventListener('mousedown', addSlideListeners);
            knob.addEventListener('touchstart', addSlideListeners);
        } else {
            console.error("Slider elements not found. Check HTML IDs.");
        }
    </script>
</body>
</html>
